<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Convert PDF tables to Excel sheets instantly. Free and easy-to-use online tool for extracting data from PDFs.">
    <meta name="keywords" content="PDF to Excel, PDF converter, extract tables, free PDF tool">
    <meta name="author" content="Your Name">
    <title>PDF to Excel Converter</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.3/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.16.105/pdf.min.js"></script>
</head>
<body>
    <header>
        <h1>PDF to Excel Converter</h1>
    </header>
    
    <!-- Google AdSense Placeholder -->
    <div class="ad-container">
        <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
             style="display:block"
             data-ad-client="ca-pub-XXXXXXXXXXXXXXX"
             data-ad-slot="XXXXXXXXXX"
             data-ad-format="auto"></ins>
        <script>
             (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
    </div>
    
    <main>
        <input type="file" id="pdfFile" accept="application/pdf">
        <button onclick="convertPDFtoExcel()">Convert to Excel</button>
        <a id="downloadLink" style="display: none;">Download Excel File</a>
    </main>

    <script>
        async function convertPDFtoExcel() {
            const fileInput = document.getElementById('pdfFile');
            if (!fileInput.files.length) {
                alert('Please select a PDF file.');
                return;
            }

            const file = fileInput.files[0];
            const reader = new FileReader();

            reader.onload = async function(event) {
                const typedarray = new Uint8Array(event.target.result);
                const pdf = await pdfjsLib.getDocument(typedarray).promise;
                let extractedData = [];

                for (let i = 1; i <= pdf.numPages; i++) {
                    const page = await pdf.getPage(i);
                    const textContent = await page.getTextContent();
                    const pageText = textContent.items.map(item => item.str).join('\t');
                    extractedData.push([pageText]);
                }

                const ws = XLSX.utils.aoa_to_sheet(extractedData);
                const wb = XLSX.utils.book_new();
                XLSX.utils.book_append_sheet(wb, ws, "Sheet1");
                const excelBuffer = XLSX.write(wb, { bookType: 'xlsx', type: 'array' });
                const data = new Blob([excelBuffer], { type: "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" });
                const url = URL.createObjectURL(data);
                const link = document.getElementById('downloadLink');
                link.href = url;
                link.download = 'converted.xlsx';
                link.style.display = 'block';
                link.innerText = 'Download Excel File';
            };

            reader.readAsArrayBuffer(file);
        }
    </script>
</body>
</html>
